{
  "model_name": "28_VisionTransformer",
  "source": "data/kernelbench/level3/28_VisionTransformer.py",
  "parameters": {
    "image_size": 224,
    "patch_size": 16,
    "num_classes": 10,
    "dim": 512,
    "depth": 6,
    "heads": 8,
    "mlp_dim": 2048,
    "channels": 3,
    "dropout": 0.0,
    "emb_dropout": 0.0
  },
  "tree": {
    "name": "vision_transformer",
    "level": 3,
    "type": "model",
    "file": "level_3_model/vision_transformer.py",
    "input_shapes": [[2, 3, 224, 224]],
    "output_shapes": [[2, 10]],
    "children": [
      {
        "name": "patch_embedding",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/patch_embedding.py",
        "input_shapes": [[2, 3, 224, 224]],
        "output_shapes": [[2, 197, 512]],
        "children": [
          {
            "name": "patch_extract_embed",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/patch_extract_embed.py",
            "input_shapes": [[2, 3, 224, 224]],
            "output_shapes": [[2, 196, 512]],
            "children": [
              {
                "name": "unfold_reshape",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/unfold_reshape.py",
                "input_shapes": [[2, 3, 224, 224]],
                "output_shapes": [[2, 196, 768]],
                "children": []
              },
              {
                "name": "linear_768x512",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/linear_768x512.py",
                "input_shapes": [[2, 196, 768]],
                "output_shapes": [[2, 196, 512]],
                "children": []
              }
            ]
          },
          {
            "name": "cls_pos_dropout",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/cls_pos_dropout.py",
            "input_shapes": [[2, 196, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": [
              {
                "name": "cls_token_expand",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/cls_token_expand.py",
                "input_shapes": [[2, 196, 512]],
                "output_shapes": [[2, 197, 512]],
                "children": []
              },
              {
                "name": "pos_embedding_add",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/pos_embedding_add.py",
                "input_shapes": [[2, 197, 512]],
                "output_shapes": [[2, 197, 512]],
                "children": []
              },
              {
                "name": "dropout_0",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/dropout_0.py",
                "input_shapes": [[2, 197, 512]],
                "output_shapes": [[2, 197, 512]],
                "children": []
              }
            ]
          }
        ]
      },
      {
        "name": "transformer_encoder_layer_0",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/transformer_encoder_layer_0.py",
        "input_shapes": [[2, 197, 512]],
        "output_shapes": [[2, 197, 512]],
        "children": [
          {
            "name": "self_attention",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/self_attention.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": [
              {
                "name": "multihead_attention_512x8",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/multihead_attention_512x8.py",
                "input_shapes": [[197, 2, 512]],
                "output_shapes": [[197, 2, 512]],
                "children": []
              },
              {
                "name": "layer_norm_512",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/layer_norm_512.py",
                "input_shapes": [[2, 197, 512]],
                "output_shapes": [[2, 197, 512]],
                "children": []
              }
            ]
          },
          {
            "name": "ffn_block",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/ffn_block.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": [
              {
                "name": "linear_512x2048",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/linear_512x2048.py",
                "input_shapes": [[2, 197, 512]],
                "output_shapes": [[2, 197, 2048]],
                "children": []
              },
              {
                "name": "relu_2048",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/relu_2048.py",
                "input_shapes": [[2, 197, 2048]],
                "output_shapes": [[2, 197, 2048]],
                "children": []
              },
              {
                "name": "dropout_ffn",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/dropout_ffn.py",
                "input_shapes": [[2, 197, 2048]],
                "output_shapes": [[2, 197, 2048]],
                "children": []
              },
              {
                "name": "linear_2048x512",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/linear_2048x512.py",
                "input_shapes": [[2, 197, 2048]],
                "output_shapes": [[2, 197, 512]],
                "children": []
              },
              {
                "name": "layer_norm_512_2",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/layer_norm_512_2.py",
                "input_shapes": [[2, 197, 512]],
                "output_shapes": [[2, 197, 512]],
                "children": []
              }
            ]
          }
        ]
      },
      {
        "name": "transformer_encoder_layer_1",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/transformer_encoder_layer_1.py",
        "input_shapes": [[2, 197, 512]],
        "output_shapes": [[2, 197, 512]],
        "children": [
          {
            "name": "self_attention",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/self_attention.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          },
          {
            "name": "ffn_block",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/ffn_block.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          }
        ]
      },
      {
        "name": "transformer_encoder_layer_2",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/transformer_encoder_layer_2.py",
        "input_shapes": [[2, 197, 512]],
        "output_shapes": [[2, 197, 512]],
        "children": [
          {
            "name": "self_attention",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/self_attention.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          },
          {
            "name": "ffn_block",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/ffn_block.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          }
        ]
      },
      {
        "name": "transformer_encoder_layer_3",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/transformer_encoder_layer_3.py",
        "input_shapes": [[2, 197, 512]],
        "output_shapes": [[2, 197, 512]],
        "children": [
          {
            "name": "self_attention",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/self_attention.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          },
          {
            "name": "ffn_block",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/ffn_block.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          }
        ]
      },
      {
        "name": "transformer_encoder_layer_4",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/transformer_encoder_layer_4.py",
        "input_shapes": [[2, 197, 512]],
        "output_shapes": [[2, 197, 512]],
        "children": [
          {
            "name": "self_attention",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/self_attention.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          },
          {
            "name": "ffn_block",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/ffn_block.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          }
        ]
      },
      {
        "name": "transformer_encoder_layer_5",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/transformer_encoder_layer_5.py",
        "input_shapes": [[2, 197, 512]],
        "output_shapes": [[2, 197, 512]],
        "children": [
          {
            "name": "self_attention",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/self_attention.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          },
          {
            "name": "ffn_block",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/ffn_block.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 197, 512]],
            "children": []
          }
        ]
      },
      {
        "name": "cls_token_extraction",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/cls_token_extraction.py",
        "input_shapes": [[2, 197, 512]],
        "output_shapes": [[2, 512]],
        "children": [
          {
            "name": "cls_extraction",
            "level": 0,
            "type": "kernel",
            "file": "level_0_kernel/cls_extraction.py",
            "input_shapes": [[2, 197, 512]],
            "output_shapes": [[2, 512]],
            "children": []
          }
        ]
      },
      {
        "name": "mlp_head",
        "level": 2,
        "type": "layer",
        "file": "level_2_layer/mlp_head.py",
        "input_shapes": [[2, 512]],
        "output_shapes": [[2, 10]],
        "children": [
          {
            "name": "mlp_head_fusion",
            "level": 1,
            "type": "fusion",
            "file": "level_1_fusion/mlp_head_fusion.py",
            "input_shapes": [[2, 512]],
            "output_shapes": [[2, 10]],
            "children": [
              {
                "name": "linear_512x2048_head",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/linear_512x2048_head.py",
                "input_shapes": [[2, 512]],
                "output_shapes": [[2, 2048]],
                "children": []
              },
              {
                "name": "gelu",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/gelu.py",
                "input_shapes": [[2, 2048]],
                "output_shapes": [[2, 2048]],
                "children": []
              },
              {
                "name": "linear_2048x10",
                "level": 0,
                "type": "kernel",
                "file": "level_0_kernel/linear_2048x10.py",
                "input_shapes": [[2, 2048]],
                "output_shapes": [[2, 10]],
                "children": []
              }
            ]
          }
        ]
      }
    ]
  }
}
