{
  "model_name": "38_LSTMBidirectional",
  "source": "data/kernelbench/level3/38_LSTMBidirectional.py",
  "description": "Bidirectional LSTM with FC output layer",
  "tree": {
    "level_3_model/lstm_bidirectional.py": {
      "level": 3,
      "type": "model",
      "description": "Complete Bidirectional LSTM model with FC output",
      "operations": ["BiLSTM", "SliceLastTimestep", "Linear"],
      "input_shapes": {
        "x": [10, 512, 128],
        "h0": [12, 10, 256],
        "c0": [12, 10, 256]
      },
      "output_shapes": [[10, 10]],
      "children": [
        "level_2_layer/bilstm.py",
        "level_2_layer/output_layer.py"
      ]
    },
    "level_2_layer/bilstm.py": {
      "level": 2,
      "type": "layer",
      "description": "Bidirectional LSTM layer (6 layers, hidden=256)",
      "operations": ["nn.LSTM(bidirectional=True)"],
      "input_shapes": {
        "x": [10, 512, 128],
        "h0": [12, 10, 256],
        "c0": [12, 10, 256]
      },
      "output_shapes": [[10, 512, 512]],
      "parent": "level_3_model/lstm_bidirectional.py",
      "children": [
        "level_1_fusion/bilstm_fusion.py"
      ]
    },
    "level_2_layer/output_layer.py": {
      "level": 2,
      "type": "layer",
      "description": "Last timestep selection followed by linear projection",
      "operations": ["SliceLastTimestep", "Linear(512, 10)"],
      "input_shapes": {
        "x": [10, 512, 512]
      },
      "output_shapes": [[10, 10]],
      "parent": "level_3_model/lstm_bidirectional.py",
      "children": [
        "level_1_fusion/slice_linear.py"
      ]
    },
    "level_1_fusion/bilstm_fusion.py": {
      "level": 1,
      "type": "fusion",
      "description": "Fused bidirectional LSTM operation",
      "operations": ["nn.LSTM(128, 256, 6, batch_first=True, bidirectional=True)"],
      "input_shapes": {
        "x": [10, 512, 128],
        "h0": [12, 10, 256],
        "c0": [12, 10, 256]
      },
      "output_shapes": [[10, 512, 512]],
      "parent": "level_2_layer/bilstm.py",
      "children": [
        "level_0_kernel/lstm_128x256_6layers_bi.py"
      ]
    },
    "level_1_fusion/slice_linear.py": {
      "level": 1,
      "type": "fusion",
      "description": "Slice last timestep and apply linear layer",
      "operations": ["SliceLastTimestep", "Linear(512, 10)"],
      "input_shapes": {
        "x": [10, 512, 512]
      },
      "output_shapes": [[10, 10]],
      "parent": "level_2_layer/output_layer.py",
      "children": [
        "level_0_kernel/slice_last_timestep.py",
        "level_0_kernel/linear_512x10.py"
      ]
    },
    "level_0_kernel/lstm_128x256_6layers_bi.py": {
      "level": 0,
      "type": "kernel",
      "description": "Bidirectional LSTM kernel: input=128, hidden=256, 6 layers",
      "operations": ["nn.LSTM"],
      "input_shapes": {
        "x": [10, 512, 128],
        "h0": [12, 10, 256],
        "c0": [12, 10, 256]
      },
      "output_shapes": [[10, 512, 512]],
      "parent": "level_1_fusion/bilstm_fusion.py",
      "children": []
    },
    "level_0_kernel/slice_last_timestep.py": {
      "level": 0,
      "type": "kernel",
      "description": "Extract last timestep from sequence: out[:, -1, :]",
      "operations": ["Slice"],
      "input_shapes": {
        "x": [10, 512, 512]
      },
      "output_shapes": [[10, 512]],
      "parent": "level_1_fusion/slice_linear.py",
      "children": []
    },
    "level_0_kernel/linear_512x10.py": {
      "level": 0,
      "type": "kernel",
      "description": "Linear projection from 512 to 10",
      "operations": ["Linear"],
      "input_shapes": {
        "x": [10, 512]
      },
      "output_shapes": [[10, 10]],
      "parent": "level_1_fusion/slice_linear.py",
      "children": []
    }
  }
}
